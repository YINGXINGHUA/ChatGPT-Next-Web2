# よくある質問

## すぐに助けを得るには？

1. ChatGPT / Bing / 百度 / Google などで質問する。
2. ネットユーザーに質問する。質問の背景情報と問題の詳細な説明を提供してください。質の高い質問は、役に立つ回答を得やすくなります。

# デプロイ関連の問題

さまざまなデプロイ方法の詳細なチュートリアルについては、以下を参照してください。[link](https://rptzik3toh.feishu.cn/docx/XtrdduHwXoSCGIxeFLlcEPsdn8b)  

## Docker デプロイバージョンで常に更新を促されるのはなぜですか？

Docker バージョンは安定版に相当し、最新の Docker は常に最新のリリースバージョンと一致します。現在、リリース頻度は 1 ～ 2 日に 1 回であるため、Docker バージョンは常に最新のコミットから 1 ～ 2 日遅れます。これは想定の範囲内です。

## Vercel にデプロイするにはどうすればよいですか？

1. Github アカウントを登録し、このプロジェクトをフォークします
2. Vercel に登録し（携帯電話による確認が必要、中国の電話番号を使用できます）、Github アカウントに接続します
3. Vercel で新しいプロジェクトを作成し、Github でフォークしたプロジェクトを選択し、必要に応じて環境変数を入力して、デプロイを開始します。デプロイ後、プロキシを使用している場合は、vercel が提供するドメイン名を使用してプロジェクトにアクセスできます。
4. 中国国内でプロキシなしでアクセスする必要がある場合：ドメイン管理 Web サイトで、cname.vercel-dns.com を指すドメインの CNAME レコードを追加します。その後、Vercel でドメインアクセスを設定します。

## Vercel 環境変数を変更するにはどうすればよいですか？

- vercel のダッシュボードページに移動します。
- NextChat プロジェクトを選択します。
- ページ上部の [設定] オプションをクリックします。
- サイドバーの [環境変数] オプションを見つけます。
- 対応する値を変更します。

## 環境変数 CODE とは何ですか？設定は必須ですか？

これは、カスタマイズされたアクセスコードです。次のいずれかを選択できます。

1. 設定しない場合は、この環境変数を削除します。注意：この場合、誰でもプロジェクトにアクセスできます。
2. プロジェクトのデプロイ時に、環境変数 CODE を設定します（複数のパスワードはカンマ区切りでサポート）。アクセスコードを設定すると、ユーザーは設定画面でアクセスコードを入力する必要があります。[関連する説明](https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web/blob/main/README.md#access-password) を参照してください

## デプロイしたバージョンでストリーミング応答がないのはなぜですか？

> 関連する議論：[＃386](https://github.com/Yidadaa/ChatGPT-Next-Web/issues/386)

nginx リバースプロキシを使用している場合は、設定ファイルに次のコードを追加する必要があります。

```
# キャッシュなし、ストリーミング出力のサポート
proxy_cache off;  # キャッシュを無効にする
proxy_buffering off;  # プロキシバッファリングを無効にする
chunked_transfer_encoding on;  # チャンク転送エンコーディングを有効にする
tcp_nopush on;  # TCP NOPUSH オプションを有効にする、Nagle アルゴリズムを無効にする
tcp_nodelay on;  # TCP NODELAY オプションを有効にする、遅延 ACK アルゴリズムを無効にする
keepalive_timeout 300;  # キープアライブタイムアウトを 65 秒に設定する
```

netlify にデプロイしている場合、この問題は解決されるまでお待ちください。

## デプロイしましたが、アクセスできません

次の問題がないか確認してください。

- サービスは開始されていますか？
- ポートは正しくマッピングされていますか？
- ファイアウォールでポートは開いていますか？
- サーバーへのルートは通っていますか？
- ドメインは正しく解決されていますか？

## プロキシとは何ですか？どのように使用しますか？

OpenAI の IP 制限により、中国やその他の国/地域では OpenAI API に直接接続できません。プロキシを使用する必要があります。プロキシサーバー（フォワードプロキシ）、または設定済みの OpenAI API リバースプロキシを使用できます。

- フォワードプロキシの例：VPN。docker デプロイの場合、環境変数 HTTP_PROXY をプロキシアドレス（例：10.10.10.10:8002）に設定します。
- リバースプロキシの例：他のユーザーが構築したプロキシアドレスを使用するか、Cloudflare を使用して無料で設定できます。プロジェクトの環境変数 BASE_URL をプロキシアドレスに設定します。

## 中国国内のサーバーにデプロイできますか？

できますが、解決する必要がある問題があります。

- github や openAI などの Web サイトに接続するには、プロキシが必要です。
- 中国国内のサーバーでドメイン解決を設定する場合は、备案が必要です。
- 中国のポリシーでは、プロキシによる外部ネットワーク/ChatGPT 関連アプリケーションへのアクセスが制限されているため、ブロックされる可能性があります。

## docker デプロイ後にネットワークエラーが発生するのはなぜですか？

詳細については、次の議論を参照してください。[link](https://github.com/Yidadaa/ChatGPT-Next-Web/issues/1569) 

# 使用関連の問題

## 「エラーが発生しました。後ほどもう一度お試しください」と表示され続けるのはなぜですか？

原因はさまざま考えられます。次の順序で確認してください。

- コードのバージョンが最新であることを確認し、最新バージョンに更新して再試行してください。
- API キーが正しく設定されていることを確認してください。環境変数名はすべて大文字とアンダースコアにする必要があります。
- API キーが使用可能であることを確認してください。
- 上記の手順を実行しても問題を特定できない場合は、issue 区で新しい issue を送信し、vercel のランタイムログまたは docker 実行時のログを添付してください。

## ChatGPT の応答が文字化けするのはなぜですか？

設定画面 - モデル設定項目に `temperature` という項目があります。この値が 1 より大きい場合、応答が文字化けする可能性があります。1 以内に調整してください。

## 使用時に「現在、未認証の状態です。設定ページでアクセスコードを入力してください」と表示されるのはなぜですか？

プロジェクトは、環境変数 CODE を使用してアクセスコードを設定しています。初めて使用する場合は、設定に移動してアクセスコードを入力する必要があります。

## 使用時に「現在のクォータを超えました...」と表示されるのはなぜですか？

API キーに問題があります。残高が不足しています。

## 使用時に「エラー：CSS チャンク xxx の読み込みに失敗しました...」というエラーが発生するのはなぜですか？

最初の画面の白紙時間を短縮するために、デフォルトでチャンクコンパイルが有効になっています。技術的な原理については、以下を参照してください。

- [Next.js Lazy Loading](https://nextjs.org/docs/app/building-your-application/optimizing/lazy-loading)  
- [Stack Overflow: Disable Chunk Code Splitting](https://stackoverflow.com/questions/55993890/how-can-i-disable-chunkcode-splitting-with-webpack4)  
- [Vercel Issue 38507](https://github.com/vercel/next.js/issues/38507)  
- [Stack Overflow: Disable Chunk Code Splitting](https://stackoverflow.com/questions/55993890/how-can-i-disable-chunkcode-splitting-with-webpack4)  

ただし、Next.JS の互換性はあまり高くなく、古いブラウザではこのエラーが発生する可能性があります。コンパイル時にチャンクコンパイルを無効にできます。 

Vercel プラットフォームの場合、環境変数に `DISABLE_CHUNK=1` を追加して、再デプロイします。
自分でコンパイルしてデプロイするプロジェクトの場合、ビルド時に `DISABLE_CHUNK=1 yarn build` を使用してビルドします。
Docker ユーザーの場合、Docker のパッケージ化時にビルドが完了しているため、この機能を無効にすることはできません。

注意：この機能を無効にすると、ユーザーは Web サイトに初めてアクセスしたときにすべてのリソースを読み込むため、ユーザーのネットワーク状況が悪い場合は、長時間白紙が表示され、ユーザーエクスペリエンスに影響を与える可能性があります。

## 使用時に「NotFoundError: 'removeChild' on 'Node': The node....」というエラーが発生するのはなぜですか？

ブラウザ自身の自動翻訳機能と、すべての自動翻訳プラグインを無効にしてください。

# ネットワークサービス関連の問題

## Cloudflare とは何ですか？

Cloudflare（CF）は、CDN、ドメイン管理、静的ページホスティング、エッジコンピューティング関数デプロイメントなどのネットワークサービスプロバイダーです。一般的な用途：ドメインの購入および/またはホスティング（解決、動的ドメインなど）、サーバーへの CDN の適用（IP を隠してブロックされるのを防ぐ）、Web サイトのデプロイ（CF Pages）。CF は、ほとんどのサービスを無料で提供しています。

## Vercel とは何ですか？

Vercel は、開発者が最新の Web アプリケーションをより迅速に構築およびデプロイできるように設計された、グローバルなクラウドプラットフォームです。このプロジェクトや多くの Web アプリケーションは、Vercel にワンクリックで無料でデプロイできます。コードの知識、linux の知識、サーバー、料金、OpenAI API プロキシの設定は必要ありません。欠点は、中国国内でプロキシなしでアクセスするには、ドメインをバインドする必要があることです。

## ドメインを取得するにはどうすればよいですか？

1. ドメインプロバイダーに登録します。海外には Namesilo（Alipay をサポート）、Cloudflare など、国内には万網などがあります。
2. 無料のドメインプロバイダー：eu.org（サブドメイン）など。
3. 友人から無料のサブドメインを要求します。

## サーバーを取得するにはどうすればよいですか？

- 海外のサーバープロバイダーの例：Amazon Web Services、Google Cloud Platform、Vultr、Bandwagon、Hostdare など。
  海外のサーバーに関する注意事項：サーバーの回線は、中国国内からのアクセス速度に影響します。CN2 GIA および CN2 回線のサーバーをお勧めします。サーバーへのアクセスが困難な場合（パケットロスが多いなど）、CDN（Cloudflare などのプロバイダー）を使用できます。
- 中国国内のサーバープロバイダー：Alibaba Cloud、Tencent Cloud など。
  中国国内のサーバーに関する注意事項：ドメインを解決するには备案が必要です。中国国内のサーバーの帯域幅は高価です。海外の Web サイト（Github、openAI など）にアクセスするには、プロキシが必要です。

## どの場合にサーバーの备案が必要ですか？

中国本土で運営されている Web サイトは、規制要件に従って备案する必要があります。実際には、サーバーが中国国内にあり、ドメイン解決が設定されている場合、サーバープロバイダーは規制の备案要件を実行します。そうでない場合、サービスは停止されます。一般的なルールは次のとおりです。
|サーバーの場所|ドメインプロバイダー|备案が必要ですか？|
|---|---|---|
|国内|国内|はい|
|国内|海外|はい|
|海外|海外|いいえ|
|海外|国内|通常はいいえ|

サーバープロバイダーを変更した後、备案を移転する必要があります。

# OpenAI 関連の問題

## OpenAI アカウントを登録するにはどうすればよいですか？

chat.openai.com にアクセスして登録します。次のものが必要です。

- 優れたプロキシ（OpenAI は、サポートされている地域のネイティブ IP アドレスをサポートしています）
- サポートされているメールアドレス（Gmail や会社/学校のメールアドレスなど、Outlook や qq メールアドレスは不可）
- SMS 認証の方法（SMS-activate Web サイトなど）

## OpenAI API を有効にするにはどうすればよいですか？API の残高を確認するにはどうすればよいですか？

公式サイトのアドレス（プロキシが必要）：[OpenAI Usage](https://platform.openai.com/account/usage)  
一部のユーザーは、プロキシなしで残高を確認できるプロキシを構築しています。ユーザーに問い合わせてください。API キーの漏洩を防ぐため、情報源が信頼できるものであることを確認してください。

## 新しく登録した OpenAI アカウントに API の残高が表示されないのはなぜですか？

（4 月 6 日更新）新しく登録されたアカウントには、通常 24 時間後に API の残高が表示されます。現在、新しく登録されたアカウントには 5 ドルの残高が付与されます。

## OpenAI API にチャージするにはどうすればよいですか？

OpenAI は、指定された地域のクレジットカードのみを受け付けています（中国のクレジットカードは使用できません）。いくつかの方法の例：

1. Depay バーチャルクレジットカード
2. 海外のクレジットカードの申請
3. オンラインで代行業者を探す

## Azure OpenAI インターフェースを使用するにはどうすればよいですか？

以下を参照してください：[＃371](https://github.com/Yidadaa/ChatGPT-Next-Web/issues/371)

## トークンの消費が非常に速いのはなぜですか？

> 関連する議論：[＃518](https://github.com/Yidadaa/ChatGPT-Next-Web/issues/518)

- GPT 4 の権限があり、日常的に GPT 4 api を使用している場合、GPT 4 の価格は GPT 3.5 の約 15 倍であるため、請求額が急増します。
- GPT 3.5 を使用していて、使用頻度は高くないにもかかわらず、請求額が急速に増加している場合は、すぐに次の手順に従って調査してください。
  - openai の Web サイトにアクセスして、API キーの消費記録を確認します。トークンが 1 時間ごとに消費され、毎回 10,000 トークン以上消費されている場合は、キーが漏洩しています。すぐに削除して再生成してください。**信頼できない Web サイトで残高を確認しないでください。**
  - パスワードが 5 文字以内の文字列など、非常に短い場合は、ブルートフォース攻撃のコストが非常に低くなります。docker のログレコードを検索して、誰かが大量のパスワードの組み合わせを試していないかどうかを確認することをお勧めします。キーワード：got access code
- 上記の 2 つの方法で、トークンが急速に消費されている理由を特定できます。
  - openai の消費記録に異常があるが、docker のログに問題がない場合は、API キーが漏洩しています。
  - docker のログに大量の「got access code」ブルートフォース攻撃の記録がある場合は、パスワードがブルートフォース攻撃されています。

## API はどのように課金されますか？

OpenAI Web サイトの課金に関する説明：[OpenAI Pricing](https://openai.com/pricing#language-models) 
OpenAI は、トークン数に基づいて課金します。1,000 トークンは、通常 750 語の英語または 500 文字の中国語に相当します。入力（プロンプト）と出力（完了）は、それぞれ個別に課金されます。
|モデル|ユーザー入力（プロンプト）の課金|モデル出力（完了）の課金|1 回のインタラクションあたりの最大トークン数|
|----|----|----|----|
|gpt-3.5-turbo|$0.0005 / 1k tokens|$0.0015 / 1k tokens|16384|
|gpt-4|$0.030 / 1k tokens|$0.060 / 1k tokens|8192|
|gpt-4-turbo|$0.010 / 1k tokens|$0.030 / 1k tokens|128000|
|gpt-4o|$0.005 / 1k tokens|$0.015 / 1k tokens|128000|